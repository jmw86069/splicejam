<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get coverage for GRanges from bigWig files — getGRcoverageFromBw • splicejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get coverage for GRanges from bigWig files — getGRcoverageFromBw" />
<meta property="og:description" content="Get coverage for GRanges from bigWig files" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.69.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
    <li>
      <a href="../articles/shiny-server-for-sashimi-plots.html">Shiny server for Sashimi Plots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/splicejam/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get coverage for GRanges from bigWig files</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/splicejam/blob/master/R/jambio-plot.R'><code>R/jambio-plot.R</code></a></small>
    <div class="hidden name"><code>getGRcoverageFromBw.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Get coverage for GRanges from bigWig files</p>
    </div>

    <pre class="usage"><span class='fu'>getGRcoverageFromBw</span><span class='op'>(</span>
  <span class='va'>gr</span>,
  <span class='va'>bwUrls</span>,
  addGaps <span class='op'>=</span> <span class='cn'>FALSE</span>,
  gap_feature_type <span class='op'>=</span> <span class='st'>"gap"</span>,
  default_feature_type <span class='op'>=</span> <span class='st'>"exon"</span>,
  feature_type_colname <span class='op'>=</span> <span class='st'>"feature_type"</span>,
  use_memoise <span class='op'>=</span> <span class='cn'>FALSE</span>,
  memoise_coverage_path <span class='op'>=</span> <span class='st'>"coverage_memoise"</span>,
  do_shiny_progress <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gr</th>
      <td><p>GRanges object</p></td>
    </tr>
    <tr>
      <th>bwUrls</th>
      <td><p>character vector of full file paths or web URLs
to bigWig files, suitable for use by <code><a href='https://rdrr.io/pkg/rtracklayer/man/export.html'>rtracklayer::import()</a></code>.</p></td>
    </tr>
    <tr>
      <th>addGaps</th>
      <td><p>logical indicating whether gaps between GRanges
should be added to the query. Gaps are determined using
<code><a href='getGRgaps.html'>getGRgaps()</a></code>. Practically, when <code>addGaps=TRUE</code> loads the
coverage data between exons, which can be a substantially
larger region than exons. When <code>addGaps=FALSE</code> the coverage
data is not loaded in intron/gap regions, and therefore is
not displayed in downstream plots like sashimi plots.</p></td>
    </tr>
    <tr>
      <th>feature_type_colname, gap_feature_type, default_feature_type</th>
      <td><p>When <code>addGaps=TRUE</code> a
new column named using <code>feature_type_colname</code> is added to <code>values(gr)</code>,
whose value for gap regions is <code>gap_feature_type</code>. When
<code>feature_type_colname</code> is already present in <code>gr</code> it is not modified,
otherwise the column is created with value <code>default_feature_type</code>.
By default, this function adds a column <code>"feature_type"</code> with
value <code>"gap"</code>.</p></td>
    </tr>
    <tr>
      <th>use_memoise</th>
      <td><p>logical indicating whether to use <code><a href='https://memoise.r-lib.org/reference/memoise.html'>memoise::memoise()</a></code>
to store coverage data in cache files, which can be re-used in
subsequent R sessions, given consistent values for
<code>memoise_coverage_path</code>.
Note that the primary reason to use memoise during this step,
is that cache files will be stored <em>for each bigWig file</em> and
not for the set of bigWig files. For example, adding one bigWig
file to <code>bwUrls</code> will cause creating of one new memoise cache file,
but will re-use any pre-existing memoise cache files for the
previously cached <code>bwUrls</code> entries.</p></td>
    </tr>
    <tr>
      <th>memoise_coverage_path</th>
      <td><p>character path to file folder
used to store coverage data in memoise cache files.
By default, the folder is a subfolder of
the current working directory (see <code><a href='https://rdrr.io/r/base/getwd.html'>getwd()</a></code>) so it should be
changed to an absolute path if needed for wider re-use in any
working directory.</p></td>
    </tr>
    <tr>
      <th>do_shiny_progress</th>
      <td><p>logical indicating whether to update
shiny progress bar, using <code><a href='https://rdrr.io/pkg/shiny/man/withProgress.html'>shiny::setProgress()</a></code>. It assumes
the progress bar is already initiated.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>DataFrame object, whose colnames are defined using
either <code><a href='https://rdrr.io/r/base/names.html'>names(bwUrls)</a></code> or by <code><a href='https://rdrr.io/pkg/jamba/man/makeNames.html'>jamba::makeNames(basename(bwUrls))</a></code>
then removing the <code>.bw</code> or <code>.bigWig</code> file extension,
case-insensitively.
Each column is type <code>IRanges::NumericList-class</code> which is a
list of numeric coverage values.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes a GRanges object to define genomic regions,
for which coverage data is loaded for each <code>bwUrls</code> input file.</p>
<p>Note that this function uses <code><a href='https://rdrr.io/pkg/rtracklayer/man/BigWigFile.html'>rtracklayer::import.bw()</a></code> which
they describe does not work on the Windows platform.</p>
<p>Update in version 0.0.68.900: This function was updated in two
subtle ways, to work around a bug in <code>rtracklater::import.bw()</code>,
which returns data sorted by chromosome in the order it is indexed
in the bigWig file, then within each chromosome entries are returned
in the order requested. This <code>getGRcoverageFromBw()</code> was updated to:</p><ol>
<li><p>Confirm input <code>gr</code> GRanges contains names, or assigns names
as needed.</p></li>
<li><p>The output coverage from <code>rtracklayer::import.gw()</code> is ordered
by <code><a href='https://rdrr.io/r/base/names.html'>names(gr)</a></code> to confirm the output coverage is returned in the
identical order as requested.</p></li>
</ol>

<p>The updates above were done outside the scope of memoise file caching,
so that stored coverage cache files will still be valid, but the
order of named entries from the cache will be dependent upon the
order requested. In the event the cache coverage contains no names,
they will be returned in the same order as stored, however it is
possible the cache will be invalidated by the addition of names
to <code>gr</code>, though unclear exactly how deeply memoise checks such things.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam GRanges functions: 
<code><a href='addGRLgaps.html'>addGRLgaps</a>()</code>,
<code><a href='addGRgaps.html'>addGRgaps</a>()</code>,
<code><a href='annotateGRLfromGRL.html'>annotateGRLfromGRL</a>()</code>,
<code><a href='annotateGRfromGR.html'>annotateGRfromGR</a>()</code>,
<code><a href='assignGRLexonNames.html'>assignGRLexonNames</a>()</code>,
<code><a href='closestExonToJunctions.html'>closestExonToJunctions</a>()</code>,
<code><a href='combineGRcoverage.html'>combineGRcoverage</a>()</code>,
<code><a href='exoncov2polygon.html'>exoncov2polygon</a>()</code>,
<code><a href='findOverlapsGRL.html'>findOverlapsGRL</a>()</code>,
<code><a href='flattenExonsBy.html'>flattenExonsBy</a>()</code>,
<code><a href='getFirstStrandedFromGRL.html'>getFirstStrandedFromGRL</a>()</code>,
<code><a href='getGRLgaps.html'>getGRLgaps</a>()</code>,
<code><a href='getGRgaps.html'>getGRgaps</a>()</code>,
<code><a href='grl2df.html'>grl2df</a>()</code>,
<code><a href='jam_isDisjoint.html'>jam_isDisjoint</a>()</code>,
<code><a href='make_ref2compressed.html'>make_ref2compressed</a>()</code>,
<code><a href='sortGRL.html'>sortGRL</a>()</code>,
<code><a href='spliceGR2junctionDF.html'>spliceGR2junctionDF</a>()</code>,
<code><a href='stackJunctions.html'>stackJunctions</a>()</code></p>
<p>Other jam RNA-seq functions: 
<code><a href='assignGRLexonNames.html'>assignGRLexonNames</a>()</code>,
<code><a href='closestExonToJunctions.html'>closestExonToJunctions</a>()</code>,
<code><a href='combineGRcoverage.html'>combineGRcoverage</a>()</code>,
<code><a href='defineDetectedTx.html'>defineDetectedTx</a>()</code>,
<code><a href='detectedTxInfo.html'>detectedTxInfo</a>()</code>,
<code><a href='exoncov2polygon.html'>exoncov2polygon</a>()</code>,
<code><a href='flattenExonsBy.html'>flattenExonsBy</a>()</code>,
<code><a href='groups2contrasts.html'>groups2contrasts</a>()</code>,
<code><a href='internal_junc_score.html'>internal_junc_score</a>()</code>,
<code><a href='makeTx2geneFromGtf.html'>makeTx2geneFromGtf</a>()</code>,
<code><a href='make_ref2compressed.html'>make_ref2compressed</a>()</code>,
<code><a href='prepareSashimi.html'>prepareSashimi</a>()</code>,
<code><a href='runDiffSplice.html'>runDiffSplice</a>()</code>,
<code><a href='sortSamples.html'>sortSamples</a>()</code>,
<code><a href='spliceGR2junctionDF.html'>spliceGR2junctionDF</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


